---
import Base from "../layouts/Base.astro";
import { getCollection } from "astro:content";

const notes = await getCollection("notes", ({ data }) => !data.draft);
const sortedNotes = notes.sort(
  (a, b) => b.data.date.getTime() - a.data.date.getTime()
);

function formatDate(date: Date): string {
  return date.toLocaleDateString("en-US", {
    year: "numeric",
    month: "short",
  });
}
---

<Base title="Notes">
  <article class="prose">
    <h1>Notes</h1>
    <p class="lead">
      Shorter essays on design philosophy, engineering practices, and lessons
      learned.
    </p>

    {sortedNotes.length === 0 ? (
      <p class="empty">No notes yet.</p>
    ) : (
      <ul class="notes-list">
        {sortedNotes.map((note) => (
          <li>
            <a href={`/notes/${note.slug}`}>{note.data.title}</a>
            <time datetime={note.data.date.toISOString()}>
              {formatDate(note.data.date)}
            </time>
          </li>
        ))}
      </ul>
    )}
  </article>
</Base>

<style>
  .empty {
    color: var(--color-text-muted);
    font-style: italic;
  }

  .notes-list {
    list-style: none;
    padding: 0;
  }

  .notes-list li {
    display: flex;
    justify-content: space-between;
    align-items: baseline;
    padding: var(--space-3) 0;
    border-bottom: 1px solid var(--color-border-subtle);
  }

  .notes-list li:last-child {
    border-bottom: none;
  }

  .notes-list time {
    font-size: var(--text-sm);
    color: var(--color-text-muted);
  }
</style>
